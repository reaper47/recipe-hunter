<!DOCTYPE html>
<html lang="en" class="h-full"
      _="on htmx:afterSwap
            if location.pathname is '/recipes' or location.pathname is '/' then
                add .active to first <button/> in mobile_nav then
                remove .active from last <button/> in mobile_nav then
                remove .md:hidden from desktop_nav then
                remove .hidden from mobile_nav then
                remove .active from first <a/> in recipes_sidebar_cookbooks then
                add .active to first <a/> in recipes_sidebar_recipes
            else if location.pathname is '/cookbooks' then
                add .active to last <button/> in mobile_nav then
                remove .active from first <button/> in mobile_nav then
                remove .md:hidden from desktop_nav then
                remove .hidden from mobile_nav then
                remove .active from first <a/> in recipes_sidebar_recipes then
                add .active to first <a/> in recipes_sidebar_cookbooks
            else if location.pathname is '/settings' or location.pathname.startsWith('/recipes/add') then
                add .md:hidden to desktop_nav then
                add .hidden to mobile_nav">
{{- template "head" .}}
<body class="min-h-full">
<header class="navbar bg-base-200 shadow-sm print:hidden">
    <div class="navbar-start">
        <a class="btn btn-ghost text-lg" {{if .IsAuthenticated}}hx-get="/" hx-push-url="true" hx-target="#content"
           {{else}}href="/"{{end}}>
            Recipya
        </a>
    </div>
    <div class="navbar-center">
        {{- if .IsAuthenticated -}}
            <div id="content-title" class="font-semibold hidden md:block md:text-xl">{{.Title}}</div>
            <button id="add_recipe" class="btn btn-primary btn-sm hover:btn-accent"
                    hx-get="/recipes/add" hx-target="#content" hx-push-url="true">
                Add recipe
            </button>
            <button id="add_cookbook" class="btn btn-primary btn-sm hover:btn-accent"
                    hx-post="/cookbooks" hx-prompt="Enter the name of your cookbook"
                    hx-target=".cookbooks-display" hx-swap="beforeend">
                Add cookbook
            </button>
        {{- end -}}
    </div>
    <div class="navbar-end">
        {{- if .IsAuthenticated -}}
            <div class="dropdown dropdown-end" hx-get="/user-initials" hx-trigger="load" hx-target="#user-initials">
                <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar placeholder">
                    <div class="bg-neutral text-neutral-content w-10 rounded-full">
                        <span id="user-initials">A</span>
                    </div>
                </div>
                <ul tabindex="0" id="avatar_dropdown"
                    class="menu dropdown-content mt-3 z-10 p-2 shadow bg-base-100 rounded-box before:content-[''] before:absolute before:right-2 before:top-[-9px] before:border-x-[15px] before:border-x-transparent before:border-b-[8px] before:border-b-[#333] dark:before:border-b-[gray]">
                    <li onclick="document.activeElement?.blur()">
                        <a href="/settings" hx-get="/settings" hx-target="#content" hx-push-url="true">
                            {{template "icon-gear"}} Settings
                        </a>
                    </li>
                    <li onclick="about_dialog.showModal()">
                        <a>{{template "icon-help"}} About</a>
                    </li>
                    <li>
                        <a hx-post="/auth/logout">
                            {{template "icon-logout"}} Log out
                        </a>
                    </li>
                </ul>
            </div>
            {{template "about-dialog" .}}
        {{- else -}}
            <a href="/auth/login" class="btn btn-ghost">Log In</a>
            <a href="/auth/register" class="btn btn-ghost">Sign Up</a>
        {{- end -}}
    </div>
</header>
<div id="fullscreen-loader" class="htmx-indicator"></div>
<main class="inline-flex w-full">
    {{- if .IsAuthenticated -}}
        <aside id="desktop_nav" class="hidden md:block">
            <ul class="menu menu-sm bg-base-300 rounded-box h-full" style="border-radius: 0">
                <li id="recipes_sidebar_recipes" hx-get="/recipes"
                    hx-target="#content" hx-push-url="true" hx-swap-oob="true">
                    <a class="tooltip tooltip-right active" data-tip="Recipes">
                        {{template "icon-cube-transparent"}}
                    </a>
                </li>
                <li id="recipes_sidebar_cookbooks" hx-get="/cookbooks"
                    hx-target="#content" hx-push-url="true" hx-swap-oob="true">
                    <a class="tooltip tooltip-right" data-tip="Cookbooks">
                        {{template "icon-book"}}
                    </a>
                </li>
            </ul>
        </aside>

        <aside id="mobile_nav" class="btm-nav btm-nav-xs md:hidden z-20">
            <button hx-get="/recipes" hx-target="#content" hx-push-url="true" hx-swap-oob="true">
                {{template "icon-cube-transparent"}}
            </button>
            <button hx-get="/cookbooks" hx-target="#content" hx-push-url="true" hx-swap-oob="true">
                {{template "icon-book"}}
            </button>
        </aside>
    {{- end -}}
    <div id="content" class="min-h-[92.5vh] w-full" hx-ext="ws" ws-connect="/ws">
        {{- template "content" .}}
    </div>
</main>
{{- template "toast" .}}
{{- template "toast-ws"}}
{{- template "toast-ws-js" -}}
</body>
</html>